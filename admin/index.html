<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理画面 | ぶち癒しフェスタ東京</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- ログイン画面 -->
    <div id="loginScreen" class="screen">
        <div class="login-container">
            <h1>🔐 管理者ログイン</h1>
            <input type="password" id="passwordInput" placeholder="パスワードを入力">
            <button id="loginBtn">ログイン</button>
            <p id="loginError" class="error hidden">パスワードが正しくありません</p>
        </div>
    </div>

    <!-- メイン管理画面 -->
    <div id="mainScreen" class="screen hidden">
        <header>
            <h1>⚙️ ぶち癒しフェスタ 管理画面</h1>
            <button id="logoutBtn" class="btn-secondary">ログアウト</button>
        </header>

        <nav class="tabs">
            <button class="tab active" data-tab="basic">📝 基本設定</button>
            <button class="tab" data-tab="pricing">💰 料金設定</button>
            <button class="tab" data-tab="booths">🪑 ブース設定</button>
            <button class="tab" data-tab="availability">📊 満枠設定</button>
            <button class="tab" data-tab="deploy">🚀 デプロイ</button>
        </nav>

        <main>
            <!-- 基本設定タブ -->
            <section id="tab-basic" class="tab-content active">
                <h2>基本設定</h2>

                <div class="form-group">
                    <label>イベント名</label>
                    <input type="text" id="eventName" placeholder="例: 第4回ぶち癒しフェスタin東京">
                    <p class="hint">フォームのタイトルなどはサイト作成時に固定されている場合がありますが、内部管理用に設定します。</p>
                </div>

                <div class="form-group">
                    <label>現在のデータ保存先 (スプレッドシートID)</label>
                    <div class="flex-row">
                        <input type="text" id="currentSpreadsheetId" placeholder="スプレッドシートID">
                        <a id="openSpreadsheetBtn" href="#" target="_blank" class="btn-secondary small">開く</a>
                    </div>
                </div>

                <div class="card mt-4">
                    <h3>📄 新しい開催回用のスプレッドシートを作成</h3>
                    <p>イベント名を元に、新しいスプレッドシートを作成してIDを自動設定します。</p>
                    <button id="createSpreadsheetBtn" class="btn-primary">新規スプレッドシートを作成</button>
                    <div id="createSpreadsheetStatus" class="status"></div>
                </div>

                <div class="form-group mt-4">
                    <label>マスターデータベースID (全履歴)</label>
                    <input type="text" id="databaseSpreadsheetId" readonly class="readonly">
                    <p class="hint">※ここは変更できません。全ての履歴がここに保存されます。</p>
                </div>
            </section>

            <!-- 料金設定タブ -->
            <section id="tab-pricing" class="tab-content hidden">
                <h2>料金設定</h2>
                <div class="form-group">
                    <label>早割締切日時</label>
                    <input type="datetime-local" id="earlyBirdDeadline">
                </div>
                <div class="form-group">
                    <label>会員割引額（円）</label>
                    <input type="number" id="memberDiscount" min="0" step="100">
                </div>
                <h3>オプション単価</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>追加椅子（円/脚）</label>
                        <input type="number" id="unitPrice_chair" min="0" step="100">
                    </div>
                    <div class="form-group">
                        <label>電源（円）</label>
                        <input type="number" id="unitPrice_power" min="0" step="100">
                    </div>
                    <div class="form-group">
                        <label>追加スタッフ（円/人）</label>
                        <input type="number" id="unitPrice_staff" min="0" step="100">
                    </div>
                    <div class="form-group">
                        <label>懇親会（円/人）</label>
                        <input type="number" id="unitPrice_party" min="0" step="100">
                    </div>
                </div>
            </section>

            <!-- ブース設定タブ -->
            <section id="tab-booths" class="tab-content hidden">
                <h2>ブース設定</h2>
                <p class="hint">各ブースの料金や制限を編集できます。</p>
                <div id="boothList"></div>
            </section>

            <!-- 満枠設定タブ -->
            <section id="tab-availability" class="tab-content hidden">
                <h2>満枠設定</h2>
                <p class="hint">満枠にしたいブースにチェックを入れてください。</p>
                <div id="availabilityList"></div>
            </section>

            <!-- デプロイタブ -->
            <section id="tab-deploy" class="tab-content hidden">
                <h2>デプロイ</h2>
                <div class="deploy-section">
                    <h3>📄 設定ファイル (config.json)</h3>
                    <p>変更した設定をGitHubに保存し、サイトに反映します。</p>
                    <button id="saveConfigBtn" class="btn-primary">設定を保存してデプロイ</button>
                    <div id="configStatus" class="status"></div>
                </div>
                <hr>
                <div class="deploy-section">
                    <h3>📜 GASスクリプト (code.gs)</h3>
                    <p>Google Apps Scriptを最新版にデプロイします。</p>
                    <button id="deployGasBtn" class="btn-primary">GASをデプロイ</button>
                    <div id="gasStatus" class="status"></div>
                </div>
            </section>
        </main>

        <footer>
            <button id="saveAllBtn" class="btn-primary btn-large">💾 すべての変更を保存</button>
        </footer>
    </div>

    <!-- ローディングオーバーレイ -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="spinner"></div>
        <p>処理中...</p>
    </div>

    <script src="script.js"></script>
</body>

</html>